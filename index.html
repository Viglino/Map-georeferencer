<!DOCTYPE html>
<html>
<head>
<!--
  Copyright (c) 2016-2018 Jean-Marc VIGLINO, 
  released under CeCILL-B (french BSD like) licence: http://www.cecill.info/
-->
  <title>Map-georeferencer</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />

  <!-- jQuery -->
  <script type="text/javascript" src="http://code.jquery.com/jquery-1.11.0.min.js"></script>

  <!-- Openlayers -->
  <link rel="stylesheet" href="http://openlayers.org/en/v4.6.5/css/ol.css" />
  <script type="text/javascript" src="http://openlayers.org/en/v4.6.5/build/ol.js"></script>
  <!-- http://openlayers.org/en/v4.6.5/build/ol-debug.js -->
  
  <!-- Geoportail-KISS -->
  <script type="text/javascript" src="https://cdn.rawgit.com/Viglino/Geoportail-KISS/gh-pages/geoportailconfig.js"></script>
  <script type="text/javascript" src="https://cdn.rawgit.com/Viglino/Geoportail-KISS/gh-pages/ol3/geoportail.js"></script>
  <script type="text/javascript" src="https://cdn.rawgit.com/Viglino/Geoportail-KISS/gh-pages/apikey.js"></script>
  
  <!-- ol-ext -->
  <link rel="stylesheet" href="https://cdn.rawgit.com/Viglino/ol-ext/v2.0.6/dist/ol-ext.min.css" />
  <script type="text/javascript" src="https://cdn.rawgit.com/Viglino/ol-ext/v2.0.6/dist/ol-ext.js"></script>	

  <link rel="stylesheet" href="georef.css" />
  <script type="text/javascript" src="helmerttransform.js"></script>
  <script type="text/javascript" src="georef.js"></script>
  <script type="text/javascript" src="wapp.img.js"></script>

  <!-- Filesaver -->
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/file-saver@2.0.0/dist/FileSaver.js"></script>

  <style>
    .github {
      position: absolute; 
      top:0; 
      left:3em; 
      background:#000; 
      color:#fff; 
      padding:0.1em 3em; 
      text-decoration:none;
      transform: rotate(-45deg) translate(-9em, 3em);
      transform-origin: 0 0 0;
      -webkit-transform: rotate(-45deg) translate(-9em, 3em);
      -webkit-transform-origin: 0 0 0;
    }
    .ol-permalink {
      display: none;
    }
  </style>
</head>
<body >
  <!-- Map div-->
  <div id="map"></div>
  <!-- Image div-->
  <div id="img"></div>

  <a class="github" href="https://github.com/Viglino/Map-georeferencer">Fork me on Github</a>

  <div class="dialog">
    <div class="modal"></div>
    <!-- Loader dialog -->
    <div id="loader" class="inner">
      <h1>Choose an image</h1>
      Upload a file:
      <input type="file" name="files[]" />
      <hr/>
      ...or choose a remote image URL (http/s)
      <br/>
      <input 
        type ="text" style="width:100%" 
        value = "https://upload.wikimedia.org/wikipedia/commons/4/4f/Achin,_Plan_de_la_ville_de_Paris_repr%C3%A9sentant_les_nouvelles_voitures_publiques,_1828.jpg"
      />
      <button style="float:right;">Georef</button>
      <br style="clear:both"/>
      <hr/>
      <i>
        Click points on the left image and on the right map.
        <br/>
        Ctrl+click point on the map to remove it.
        <br/>
        Click+drag to move points.
        <hr/>
        Save the map and drag and drop the file to add the georeferenced layer on the map.
      </i>
    </div>
  </div>

  <div id="loading" class="dialog hidden" style="">
    <div class="inner">
      <h1>
        <i class="fa fa-2x fa-spinner fa-pulse" style="vertical-align:middle; margin-right:0.5em;"></i>
        Loading...
        <img class="preview" />
      </h1>
    </div>
  </div>

  <div id="info" class="dialog hidden">
    <div class="inner">
      <i class="fa fa-close fa-2x" style="float:right; color:#369; cursor:pointer" onclick="$('#info').addClass('hidden');" ></i>
      <h1>Georef:</h1>
      <textarea style="max-width:100%; min-width:100%; box-sizing:border-box; min-height:12em;"></textarea>
      <button onclick="wapp.exportMap()" style="float:right;">export Map...</button>
    </div>
  </div>
</body>
</html>